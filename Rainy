-- UI ONLY + DRAGGABLE (kh√¥ng c√≥ b·∫•t k√¨ ch·ª©c nƒÉng chat/loading/toggle n√†o)

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Cleanup old
pcall(function()
	local old = playerGui:FindFirstChild("RainyLuckyBlockUI")
	if old then old:Destroy() end
end)

local function round(ui, r)
	local c = Instance.new("UICorner")
	c.CornerRadius = UDim.new(0, r)
	c.Parent = ui
	return c
end

-- ===== UI =====
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "RainyLuckyBlockUI"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = playerGui

local container = Instance.new("Frame")
container.Size = UDim2.new(0, 340, 0, 160)
container.Position = UDim2.new(0.5, 0, 0.5, 0)
container.AnchorPoint = Vector2.new(0.5, 0.5)
container.BackgroundColor3 = Color3.fromRGB(14, 18, 24)
container.BackgroundTransparency = 0.06
container.BorderSizePixel = 0
container.Parent = screenGui
round(container, 16)

local stroke = Instance.new("UIStroke")
stroke.Thickness = 1
stroke.Transparency = 0.45
stroke.Color = Color3.fromRGB(110, 140, 190)
stroke.Parent = container

-- Header (draggable)
local header = Instance.new("Frame")
header.Size = UDim2.new(1, 0, 0, 42)
header.BackgroundColor3 = Color3.fromRGB(20, 26, 36)
header.BorderSizePixel = 0
header.Parent = container
round(header, 16)

local headerGrad = Instance.new("UIGradient")
headerGrad.Rotation = 90
headerGrad.Color = ColorSequence.new({
	ColorSequenceKeypoint.new(0, Color3.fromRGB(70, 120, 210)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(20, 26, 36))
})
headerGrad.Parent = header

local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -60, 1, 0)
title.Position = UDim2.new(0, 12, 0, 0)
title.BackgroundTransparency = 1
title.Text = "RAINY LUCKY BLOCK"
title.TextColor3 = Color3.fromRGB(240, 246, 252)
title.Font = Enum.Font.GothamSemibold
title.TextSize = 16
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = header

local closeBtn = Instance.new("TextButton")
closeBtn.Size = UDim2.new(0, 34, 0, 26)
closeBtn.Position = UDim2.new(1, -40, 0, 8)
closeBtn.BackgroundColor3 = Color3.fromRGB(32, 38, 52)
closeBtn.BorderSizePixel = 0
closeBtn.AutoButtonColor = false
closeBtn.Text = "‚ùå"
closeBtn.TextColor3 = Color3.fromRGB(230, 235, 245)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 16
closeBtn.Parent = header
round(closeBtn, 10)

local closeStroke = Instance.new("UIStroke")
closeStroke.Thickness = 1
closeStroke.Transparency = 0.65
closeStroke.Color = Color3.fromRGB(120, 140, 170)
closeStroke.Parent = closeBtn

-- ch·ªâ UI (kh√¥ng destroy, kh√¥ng chat), hover nh·∫π
closeBtn.MouseEnter:Connect(function()
	closeBtn.BackgroundColor3 = Color3.fromRGB(44, 52, 70)
end)
closeBtn.MouseLeave:Connect(function()
	closeBtn.BackgroundColor3 = Color3.fromRGB(32, 38, 52)
end)

local subtitle = Instance.new("TextLabel")
subtitle.Size = UDim2.new(1, -18, 0, 16)
subtitle.Position = UDim2.new(0, 12, 0, 46)
subtitle.BackgroundTransparency = 1
subtitle.Text = "Waiting to turn on the lucky block rain"
subtitle.TextColor3 = Color3.fromRGB(160, 170, 185)
subtitle.Font = Enum.Font.Gotham
subtitle.TextSize = 12
subtitle.TextXAlignment = Enum.TextXAlignment.Left
subtitle.Parent = container

local button = Instance.new("TextButton")
button.Size = UDim2.new(0.92, 0, 0, 50)
button.Position = UDim2.new(0.04, 0, 0, 86)
button.BackgroundColor3 = Color3.fromRGB(34, 92, 180)
button.BorderSizePixel = 0
button.AutoButtonColor = false
button.Text = "Rainy Lucky Blocküé≤"
button.TextColor3 = Color3.fromRGB(255, 255, 255)
button.Font = Enum.Font.GothamBold
button.TextSize = 15
button.Parent = container
round(button, 12)

local btnGrad = Instance.new("UIGradient")
btnGrad.Rotation = 90
btnGrad.Color = ColorSequence.new({
	ColorSequenceKeypoint.new(0, Color3.fromRGB(70, 150, 240)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(34, 92, 180))
})
btnGrad.Parent = button

-- Hover nh·∫π cho n√∫t (UI only)
button.MouseEnter:Connect(function()
	btnGrad.Color = ColorSequence.new({
		ColorSequenceKeypoint.new(0, Color3.fromRGB(160, 225, 255)),
		ColorSequenceKeypoint.new(1, Color3.fromRGB(70, 150, 240))
	})
end)
button.MouseLeave:Connect(function()
	btnGrad.Color = ColorSequence.new({
		ColorSequenceKeypoint.new(0, Color3.fromRGB(70, 150, 240)),
		ColorSequenceKeypoint.new(1, Color3.fromRGB(34, 92, 180))
	})
end)

-- ===== DRAGGABLE (header only) =====
local dragging = false
local dragStart, startPos, activeInput

header.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		activeInput = input
		dragStart = input.Position
		startPos = container.Position

		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
				activeInput = nil
			end
		end)
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if dragging and input == activeInput then
		local delta = input.Position - dragStart
		container.Position = UDim2.new(
			startPos.X.Scale, startPos.X.Offset + delta.X,
			startPos.Y.Scale, startPos.Y.Offset + delta.Y
		)
	end
end)
