-- LavaDuplicateUI.lua
-- LocalScript: ƒë·∫∑t file n√†y trong StarterPlayerScripts ho·∫∑c PlayerGui (ph·∫£i l√† LocalScript)

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
if not player then
    warn("This script must run as a LocalScript (Player not found).")
    return
end

local playerGui = player:WaitForChild("PlayerGui")

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "LavaDuplicateUI"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = playerGui

-- M·ªôt Folder ƒë·ªÉ ch·ª©a UI ch√≠nh (ƒë·ªÉ toggle ch·ªâ ·∫©n ph·∫ßn UI n√†y, kh√¥ng ·∫©n n√∫t toggle)
local uiContainer = Instance.new("Folder", ScreenGui)
uiContainer.Name = "UIContainer"

-- VI·ªÄN CAM D√ÄY (parent v√†o uiContainer ƒë·ªÉ c√≥ th·ªÉ ·∫©n c√πng nhau)
local border = Instance.new("Frame")
border.Size = UDim2.new(0, 368, 0, 188)
border.Position = UDim2.new(0.5, -184, 0.5, -94)
border.BackgroundColor3 = Color3.fromRGB(255,140,0) -- cam lava
border.BorderSizePixel = 0
border.Parent = uiContainer
local borderCorner = Instance.new("UICorner", border)
borderCorner.CornerRadius = UDim.new(0, 16)

-- MAIN UI (glass n·∫±m trong border)
local glass = Instance.new("Frame", border)
glass.Size = UDim2.new(0, 360, 0, 180)
glass.Position = UDim2.new(0.5, -180, 0.5, -90)
glass.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
glass.BorderSizePixel = 0
local uiCorner = Instance.new("UICorner", glass)
uiCorner.CornerRadius = UDim.new(0, 12)

-- Title (ch·ªâ k√©o khi b·∫•m gi·ªØ title)
local title = Instance.new("TextLabel", glass)
title.Size = UDim2.new(1, -20, 0, 40)
title.Position = UDim2.new(0,10,0,0)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.Text = "üî•Lava Duplicateüî•"
title.TextColor3 = Color3.fromRGB(255,120,60)
title.TextXAlignment = Enum.TextXAlignment.Center
title.TextScaled = false
title.ClipsDescendants = true
title.Name = "TitleBar"

-- Status
local status = Instance.new("TextLabel", glass)
status.Position = UDim2.new(0, 10, 0, 45)
status.Size = UDim2.new(1, -20, 0, 22)
status.BackgroundTransparency = 1
status.Text = "Status: Ready ‚úÖ"
status.Font = Enum.Font.Code
status.TextSize = 16
status.TextColor3 = Color3.fromRGB(80,255,80)
status.TextXAlignment = Enum.TextXAlignment.Left
status.TextWrapped = true

-- Button
local startBtn = Instance.new("TextButton", glass)
startBtn.Position = UDim2.new(0.5, -130, 0.7, -20)
startBtn.Size = UDim2.new(0, 260, 0, 40)
startBtn.Text = "Start Duplication üß†"
startBtn.Font = Enum.Font.GothamBold
startBtn.TextSize = 18
startBtn.BackgroundColor3 = Color3.fromRGB(255,90,40)
startBtn.TextColor3 = Color3.fromRGB(230,230,230)
local btnCorner = Instance.new("UICorner", startBtn)
btnCorner.CornerRadius = UDim.new(0,10)
startBtn.TextWrapped = true

-- Popup Folder (parent v√†o uiContainer ƒë·ªÉ toggle ·∫©n c√πng)
local popupFolder = Instance.new("Folder")
popupFolder.Name = "Popups"
popupFolder.Parent = uiContainer

local function createPopup(icon, titleText, message)
    local popup = Instance.new("Frame")
    popup.Size = UDim2.new(0, 260, 0, 90)
    popup.Position = UDim2.new(1, 260, 0.05, (#popupFolder:GetChildren()*95))
    popup.BackgroundColor3 = Color3.fromRGB(255,120,60)
    popup.BorderSizePixel = 0
    popup.Parent = popupFolder
    local corner = Instance.new("UICorner", popup)
    corner.CornerRadius = UDim.new(0, 12)

    local iconLabel = Instance.new("TextLabel", popup)
    iconLabel.Size = UDim2.new(0, 40, 0, 40)
    iconLabel.Position = UDim2.new(0, 10, 0, 10)
    iconLabel.BackgroundTransparency = 1
    iconLabel.Font = Enum.Font.GothamBold
    iconLabel.TextSize = 28
    iconLabel.Text = icon
    iconLabel.TextColor3 = Color3.new(1,1,1)

    local text1 = Instance.new("TextLabel", popup)
    text1.Size = UDim2.new(1, -60, 0, 22)
    text1.Position = UDim2.new(0, 55, 0, 8)
    text1.BackgroundTransparency = 1
    text1.Font = Enum.Font.GothamBold
    text1.TextSize = 16
    text1.TextColor3 = Color3.new(1,1,1)
    text1.TextXAlignment = Enum.TextXAlignment.Left
    text1.Text = titleText
    text1.TextWrapped = true

    local text2 = Instance.new("TextLabel", popup)
    text2.Size = UDim2.new(1, -60, 0, 50)
    text2.Position = UDim2.new(0, 55, 0, 28)
    text2.BackgroundTransparency = 1
    text2.Font = Enum.Font.Gotham
    text2.TextWrapped = true
    text2.TextSize = 14
    text2.TextColor3 = Color3.new(1,1,1)
    text2.TextXAlignment = Enum.TextXAlignment.Left
    text2.Text = message

    task.spawn(function()
        -- Fade In + Slide In
        for i = 0,1,0.05 do
            popup.BackgroundTransparency = 1-i
            popup.Position = popup.Position:Lerp(UDim2.new(1, -280, popup.Position.Y.Scale, popup.Position.Y.Offset),0.25)
            task.wait(0.02)
        end

        task.wait(5)

        -- Fade Out + Slide Out
        for i = 0,1,0.05 do
            popup.BackgroundTransparency = i
            popup.Position = popup.Position:Lerp(UDim2.new(1, 260, popup.Position.Y.Scale, popup.Position.Y.Offset),0.25)
            task.wait(0.02)
        end

        popup:Destroy()
    end)
end

-- Dot animation
local function animateDots(label,text,duration)
    local patterns={".","..","..."}
    local idx,elapsed=1,0
    while elapsed<duration do
        label.Text=text.." "..patterns[idx]
        idx = idx+1
        if idx>#patterns then idx=1 end
        task.wait(0.35)
        elapsed = elapsed + 0.35
    end
end

-- Start button sequence (gi·ªØ nguy√™n logic)
startBtn.MouseButton1Click:Connect(function()
    if startBtn.Text=="Running..." then return end
    startBtn.Text="Running..."
    startBtn.TextColor3 = Color3.fromRGB(230,230,230)

    -------------------------
    -- Step 1 ‚Üí Anti Ban
    -------------------------
    animateDots(startBtn,"Wait for Enable Anti Ban üõ°Ô∏è",2)
    startBtn.Text="Anti Ban Enabled üõ°Ô∏è"
    startBtn.TextColor3=Color3.fromRGB(80,255,80)
    status.Text="Status: Anti Ban Enabled üõ°Ô∏è"
    status.TextColor3=Color3.fromRGB(80,255,80)
    createPopup("üõ°Ô∏è","üî•LAVA DUPLICATEüî•",
        "Anti Ban Enableüõ°Ô∏è now you can Duplicate without being bannedüëæ")
    task.wait(1)
    status.Text="Status: Ready ‚úÖ"

    -------------------------
    -- NEW ADVANCED STEPS
    -------------------------
    animateDots(startBtn,"Bypassing anti-cheat hash checks",2)
    task.wait(2)
    animateDots(startBtn,"Finalizing instance synchronization",2)
    task.wait(2)
    animateDots(startBtn,"Allocating memory for new instances",2)
    task.wait(2)
    animateDots(startBtn,"Replicating object properties",2)
    task.wait(2)
    animateDots(startBtn,"Injecting duplication packets",2)
    task.wait(2)

    -------------------------
    -- Step 2 ‚Üí Duplication Start
    -------------------------
    createPopup("üß†","üî•LAVA DUPLICATEüî•",
        "Duplication Started üß† now you can Duplicate your brainrot‚öôÔ∏è")
    animateDots(startBtn,"Duplication üß†",3)

    -------------------------
    -- Step 3 ‚Üí Completed
    -------------------------
    startBtn.Text="Duplicate Completed ‚úÖ"
    startBtn.TextColor3=Color3.fromRGB(80,255,80)
    status.Text="Status: Duplicate Completed ‚úÖ"
    status.TextColor3=Color3.fromRGB(80,255,80)
    createPopup("‚úÖ","üî•LAVA DUPLICATEüî•",
        "Once your brainrots are cloned‚úÖ, grab it and place it in another box‚öôÔ∏è")

    task.wait(1.5)

    -- Reset
    startBtn.TextColor3=Color3.fromRGB(230,230,230)
    startBtn.Text="Start Duplication üß†"
    status.Text="Status: Ready ‚úÖ"
    status.TextColor3=Color3.fromRGB(80,255,80)
end)

-- ========== TOGGLE UI (n√∫t lu√¥n hi·ªÉn th·ªã) ==========
local toggleBtn = Instance.new("TextButton", ScreenGui)
toggleBtn.Name = "ToggleUIButton"
toggleBtn.Size = UDim2.new(0, 36, 0, 36)
toggleBtn.Position = UDim2.new(0.95, -46, 0.05, 10) -- g√≥c ph·∫£i tr√™n
toggleBtn.AnchorPoint = Vector2.new(1, 0)
toggleBtn.BackgroundColor3 = Color3.fromRGB(40,40,40)
toggleBtn.TextColor3 = Color3.new(1,1,1)
toggleBtn.Text = "Hide"
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 14
toggleBtn.BorderSizePixel = 0
local toggleCorner = Instance.new("UICorner", toggleBtn)
toggleCorner.CornerRadius = UDim.new(0,8)

local uiVisible = true
local function setUIVisible(v)
    uiVisible = v
    uiContainer.Parent = v and ScreenGui or nil -- remove/add container ƒë·ªÉ ·∫©n/hi·ªán to√†n b·ªô UI (s·∫°ch)
    toggleBtn.Text = v and "Hide" or "Show"
end

toggleBtn.MouseButton1Click:Connect(function()
    setUIVisible(not uiVisible)
end)

-- Ph√≠m t·∫Øt: RightControl ƒë·ªÉ b·∫≠t/t·∫Øt nhanh
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    if input.UserInputType == Enum.UserInputType.Keyboard then
        if input.KeyCode == Enum.KeyCode.RightControl then
            setUIVisible(not uiVisible)
        end
    end
end)

-- ========== DRAG (k√©o th·∫£) ==========
-- S·ª≠ d·ª•ng title l√†m "topbar" ƒë·ªÉ k√©o (·ªïn ƒë·ªãnh h∆°n)
local dragging = false
local dragStartPos = nil -- v·ªã tr√≠ chu·ªôt l√∫c b·∫Øt ƒë·∫ßu k√©o (Vector2)
local windowStartPos = nil -- v·ªã tr√≠ pixel c·ªßa border l√∫c b·∫Øt ƒë·∫ßu k√©o (Vector2)

local function clampToViewport(x,y)
    local cam = workspace.CurrentCamera
    local view = cam and cam.ViewportSize or Vector2.new(1920,1080)
    local size = border.AbsoluteSize or Vector2.new(border.Size.X.Offset, border.Size.Y.Offset)
    local nx = math.clamp(x, 0, view.X - size.X)
    local ny = math.clamp(y, 0, view.Y - size.Y)
    return nx, ny
end

title.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStartPos = input.Position
        windowStartPos = Vector2.new(border.AbsolutePosition.X, border.AbsolutePosition.Y)
        -- khi input k·∫øt th√∫c, d·ª´ng k√©o
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if not dragging then return end
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        local delta = input.Position - dragStartPos
        local newX = windowStartPos.X + delta.X
        local newY = windowStartPos.Y + delta.Y
        newX, newY = clampToViewport(newX, newY)
        border.Position = UDim2.new(0, newX, 0, newY)
    end
end)

-- Kh·ªüi t·∫°o hi·ªÉn th·ªã m·∫∑c ƒë·ªãnh
setUIVisible(true)
